---
title: "Statistical Summaries"
author: "Ian Morelan"
date: "8/12/2020"
output: 
  word_document:
    toc: yes
---

```{r setup, include=FALSE}
source("setup.R")
source("alpha_diversity.R")
library(broom)
```

# Results
## Climate

### Growing degree days (GDD)
```{r gdd, comment="->", echo=FALSE, results='asis'}
# Means and SDs


# by vintage
merge_samdat %>% 
   filter(Vineyard != "AV2" ) %>% 
  filter(Vineyard != "OR2")%>%
  group_by(Year)  %>% 
  summarise(mean=mean(Growing.Degree.Days),
            sd=sd(Growing.Degree.Days))%>%
  kable(caption="  \n**Vintage GDD means and SDs**")


# Paired t-test
t.test(x=merge_samdat %>% 
         filter(Year ==2016) %>% 
         select(Growing.Degree.Days)%>% 
         unlist, 
       y=merge_samdat %>% 
         filter(Year ==2017) %>% 
         filter(Vineyard != "AV2" ) %>% 
         filter(Vineyard != "OR2")%>%
         select(Growing.Degree.Days) %>% 
         unlist, paired = TRUE) %>% tidy %>%
  kable(caption="  \n**Paired t-test of GDD values between vintages**")


# by AVA
merge_samdat %>% 
  filter(Year ==2016) %>% 
  group_by(AVA) %>% 
  summarise(mean=mean(Growing.Degree.Days),
            sd=sd(Growing.Degree.Days),min=min(Growing.Degree.Days), max=max(Growing.Degree.Days)) %>% kable(caption="  \n**2016 means, SDs, min, max (by AVA)**")



# ANOVA 2016 (ns so no Tukey's HSD)
aov(formula = Growing.Degree.Days~AVA,
    data = merge_samdat %>% 
      filter(Year==2016))%>% 
  tidy %>% kable(caption = "  \n**One-way ANOVA of GDD values (2016 vintage)**")

# by AVA 
merge_samdat %>% 
  filter(Year ==2017) %>% 
  group_by(AVA) %>% 
  summarise(mean=mean(Growing.Degree.Days),
            sd=sd(Growing.Degree.Days), min=min(Growing.Degree.Days), max=max(Growing.Degree.Days)) %>% kable(caption="  \n**2017 means, SDs, min, max (by AVA)**")
  
# ANOVA 2017 
aov(formula = Growing.Degree.Days~AVA,
    data = merge_samdat %>% filter(Year==2017)) %>% 
 tidy %>% kable(caption = "  \n**One-way ANOVA of GDD values (2017 vintage)**")
aov(formula = Growing.Degree.Days~AVA,
    data = merge_samdat %>% filter(Year==2017)) %>%
  TukeyHSD %>% tidy %>% kable(caption="  \n**Tukey's HSD of GDD values (2017 vintage)**")


```

### Precipitation


```{r precipitation, tidy=TRUE, comment="->", echo=FALSE}

# Means and SDs
# by vintage
merge_samdat %>% 
   filter(Vineyard != "AV2" ) %>% 
  filter(Vineyard != "OR2")%>%
  group_by(Year)  %>% 
  summarise(mean=mean(Precipitation.growing),
            sd=sd(Precipitation.growing))%>%
  kable(caption="  \n**Vintage precipitation means and SDs**")


# t test on log transformed values
t.test(x=merge_samdat %>%
         filter(Year ==2016) %>% 
         select(Precipitation.growing)%>% 
         unlist%>% 
         log, 
       y=merge_samdat %>% 
         filter(Year ==2017) %>% 
         filter(Vineyard != "AV2" ) %>% 
         filter(Vineyard != "OR2")%>%
         select(Precipitation.growing) %>% 
         unlist %>% log,
       paired = TRUE)%>% tidy %>%
  kable(caption="  \n**Paired t-test of log transformed growing season precipitation values between vintages**")


# by AVA
merge_samdat %>% 
  filter(Year ==2016) %>% 
  group_by(AVA) %>% 
  summarise(mean=mean(Precipitation.growing),
            sd=sd(Precipitation.growing), min=min(Precipitation.growing), max=max(Precipitation.growing)) %>% kable(caption="  \n**2016 means, SDs, min, max (by AVA)**")

# ANOVA 2016 (on log transformed values)
aov(formula = log(Precipitation.growing)~AVA,
    data = merge_samdat %>% 
      filter(Year==2016)) %>% 
  tidy %>% kable(caption = "  \n**One-way ANOVA of log transformed growing season precipitation values (2016 vintage)**")

#significant, so followed with Tukey's HSD
aov(formula = log(Precipitation.growing)~AVA,
    data = merge_samdat %>% 
      filter(Year==2016)) %>% 
  TukeyHSD %>%
 tidy %>% kable(caption="  \n**Tukey's HSD of log transformed growing precipitation values values (2016 vintage)**")

# by AVA (all included, because this corresponds with ANOVA)
merge_samdat %>% 
  filter(Year ==2017) %>% 
  group_by(AVA) %>% 
  summarise(mean=mean(Precipitation.growing),
            sd=sd(Precipitation.growing), min=min(Precipitation.growing), max=max(Precipitation.growing)) %>% kable(caption="  \n**2017 means, SDs, min, max (by AVA)**")

# ANOVA 2017 (on log transformed values)
aov(formula = log(Precipitation.growing) ~AVA,
    data = merge_samdat %>% 
      filter(Year==2017)) %>% 
  tidy %>% kable(caption = "  \n**One-way ANOVA of log transformed growing season precipitation values (2017 vintage)**")

#significant, so followed with Tukey's HSD
aov(formula = log(Precipitation.growing) ~AVA,
    data = merge_samdat %>% 
      filter(Year==2017)) %>% 
  TukeyHSD%>%
   tidy %>% kable(caption="  \n**Tukey's HSD of log transformed growing precipitation values values (2017 vintage)**")

```

## Fruit maturity

### pH

```{r pH, tidy=TRUE, comment="->", echo=FALSE}

# Means and SDs
# by vintage
merge_samdat %>% 
   filter(Vineyard != "AV2" ) %>% 
  filter(Vineyard != "OR2")%>%
  group_by(Year)  %>% 
  summarise(mean=mean(Must_pH),
            sd=sd(Must_pH))%>%
  kable(caption="  \n**Vintage pH means and SDs**")

# t test 
t.test(x=merge_samdat %>% filter(Year ==2016) %>% select(Must_pH)%>% unlist%>% log %>% as.numeric(), 
       y=merge_samdat %>% filter(Year ==2017) %>% filter(Vineyard != "AV2" ) %>% filter(Vineyard != "OR2")%>%
         select(Must_pH) %>% unlist %>% log %>% as.numeric(), paired = TRUE)%>% tidy %>%
  kable(caption="  \n**Paired t-test of pH between vintages**")


# by AVA
merge_samdat %>% 
  filter(Year ==2016) %>% 
  group_by(AVA) %>% 
  summarise(mean=mean(Must_pH),
            sd=sd(Must_pH), min=min(Must_pH), max=max(Must_pH)) %>% kable(caption="  \n**2016 means, SDs, min, max (by AVA)**")

#ANOVA 2016 (ns so no Tukey's HSD)
aov(formula = Must_pH ~AVA,
    data = merge_samdat %>% 
      filter(Year==2016)) %>% 
  tidy %>% kable(caption = "  \n**One-way ANOVA of pH (2016 vintage)**")
  

# by AVA
merge_samdat %>% 
  filter(Year ==2017) %>% 
  group_by(AVA) %>% 
  summarise(mean=mean(Must_pH),
            sd=sd(Must_pH), min=min(Must_pH), max=max(Must_pH)) %>% kable(caption="  \n**2017 means, SDs, min, max (by AVA)**")


# ANOVA 2017 (ns so no Tukey's HSD)
aov(formula = Must_pH ~AVA,
    data = merge_samdat %>% 
      filter(Year==2017))%>% 
  tidy %>% kable(caption = "  \n**One-way ANOVA of pH (2017 vintage)**") 
```

### Titratable acidity (TA)

```{r TA, tidy=TRUE, comment="->", echo=FALSE}


# Means and SDs
# by vintage
merge_samdat %>% 
   filter(Vineyard != "AV2" ) %>% 
  filter(Vineyard != "OR2")%>%
  group_by(Year)  %>% 
  summarise(mean=mean(Must_TA),
            sd=sd(Must_TA))%>%
  kable(caption="  \n**Vintage pH means and SDs**")

# t test 
t.test(x=merge_samdat %>% 
         filter(Year ==2016) %>% 
         select(Must_TA)%>% 
         unlist%>% log, 
       y=merge_samdat %>% 
         filter(Year ==2017) %>% 
         filter(Vineyard != "AV2" ) %>% 
         filter(Vineyard != "OR2")%>%
         select(Must_TA) %>% unlist %>% log, 
       paired = TRUE)%>% tidy %>%
  kable(caption="  \n**Paired t-test of titratable acidity values between vintages**")


# by AVA
merge_samdat %>% 
  filter(Year ==2016) %>% 
  group_by(AVA) %>% 
  summarise(mean=mean(Must_TA),
            sd=sd(Must_TA), min=min(Must_TA), max=max(Must_TA)) %>% kable(caption="  \n**2016 means, SDs, min, max (by AVA)**")

# ANOVA 2016 (ns so no Tukey's HSD)
aov(formula = Must_TA ~AVA,
    data = merge_samdat %>% 
      filter(Year==2016)) %>% 
  tidy %>% kable(caption = "  \n**One-way ANOVA of titratable acidity values (2016 vintage)**")


#
# by AVA
merge_samdat %>% 
  filter(Year ==2017) %>% 
  group_by(AVA) %>% 
  summarise(mean=mean(Must_TA),
            sd=sd(Must_TA), min=min(Must_TA), max=max(Must_TA)) %>% kable(caption="  \n**2017 means, SDs, min, max (by AVA)**")



# ANOVA 2017 (ns so no Tukey's HSD)
aov(formula = Must_TA~AVA,
    data = merge_samdat %>% 
      filter(Year==2017)) %>% 
  tidy %>% kable(caption = "  \n**One-way ANOVA of titratable acidity values (2017 vintage)**")

```

### Total soluble solids (TSS)

```{r TSS, tidy=TRUE, comment="->", echo=FALSE}

#Means and SDs
# by vintage
merge_samdat %>% 
   filter(Vineyard != "AV2" ) %>% 
  filter(Vineyard != "OR2")%>%
  group_by(Year)  %>% 
  summarise(mean=mean(Must_TSS),
            sd=sd(Must_TSS))%>%
  kable(caption="  \n**Vintage TSS means and SDs**")
# t test 
t.test(x=merge_samdat %>% 
         filter(Year ==2016) %>% 
         select(Must_TSS)%>% unlist , 
       y=merge_samdat %>% 
         filter(Year ==2017) %>% 
         filter(Vineyard != "AV2" ) %>% 
         filter(Vineyard != "OR2")%>%
         select(Must_TSS) %>% unlist , 
       paired = TRUE)%>% tidy %>%
  kable(caption="  \n**Paired t-test of TSS values between vintages**")




# by AVA
merge_samdat %>% 
  filter(Year ==2016) %>% 
  group_by(AVA) %>% 
  summarise(mean=mean(Must_TSS),
            sd=sd(Must_TSS), min=min(Must_TSS), max=max(Must_TSS)) %>% kable(caption="  \n**2016 means, SDs, min, max (by AVA)**")


# ANOVA 2016 (ns so no Tukey's HSD)
aov(formula = Must_TSS~AVA,
    data = merge_samdat %>% 
      filter(Year==2016))%>% 
  tidy %>% kable(caption = "  \n**One-way ANOVA of TSS values (2016 vintage)**")

# by AVA
merge_samdat %>% 
  filter(Year ==2017) %>% 
  group_by(AVA) %>% 
  summarise(mean=mean(Must_TSS),
            sd=sd(Must_TSS), min=min(Must_TSS), max=max(Must_TSS)) %>% kable(caption="  \n**2017 means, SDs, min, max (by AVA)**")

# ANOVA 2017 (ns so no Tukey's HSD)
aov(formula = Must_TSS %>% log ~AVA,
    data = merge_samdat %>% 
      filter(Year==2017)) %>% 
  tidy %>% kable(caption = "  \n**One-way ANOVA of TSS values (2017 vintage)**")




```

## Alpha Diversity
### Bacterial alpha diversity
#### Richness

```{r richness, echo=FALSE}

# Means and SDs
# by vintage
bact_alpha_test_df %>% 
   filter(Vineyard != "AV2" ) %>% 
  filter(Vineyard != "OR2")%>%
  group_by(Year)  %>% 
  summarise(mean=mean(Richness),
            sd=sd(Richness))%>%
  kable(caption="  \n**Vintage richness means and SDs**")

# t test (if both are not significant)
t.test(x=bact_alpha_test_df %>% 
         filter(Year ==2016) %>% 
         select(Richness)%>% unlist, 
       y=bact_alpha_test_df %>% 
         filter(Year ==2017) %>% 
         filter(Vineyard != "AV2" ) %>% 
         filter(Vineyard != "OR2")%>%
         select(Richness) %>% unlist, 
       paired = TRUE) %>% tidy %>%
  kable(caption="  \n**Paired t-test of richness values between vintages**")


# by AVA
bact_alpha_test_df %>% 
  filter(Year ==2016) %>% 
  group_by(AVA) %>% 
  summarise(mean=mean(Richness), sd=sd(Richness))%>%
  kable(caption="  \n**2016 richness means and SDs (by AVA)**")


#ANOVA 2016
aov(formula = Richness~AVA,
    data = bact_alpha_test_df %>% 
      filter(Year==2016)) %>% 
  tidy %>% kable(caption = "  \n**One-way ANOVA of richness values (2016 vintage)**")

# Tukey's HSD 2016
aov(formula = Richness~AVA,
    data = bact_alpha_test_df %>% 
      filter(Year==2016)) %>% 
  TukeyHSD()%>% tidy %>% kable(caption="  \n**Tukey's HSD of richness values (2016 vintage)**")

# by AVA (all included, because this corresponds with ANOVA)
bact_alpha_test_df %>% 
  filter(Year ==2017) %>% 
  group_by(AVA) %>% 
  summarise(mean=mean(Richness), sd=sd(Richness))%>%
  kable(caption="  \n**2017 richness means and SDs (by AVA)**")

# ANOVA 2017
aov(formula = Richness~AVA,
    data = bact_alpha_test_df %>% 
      filter(Year==2017)) %>% 
  tidy %>% kable(caption = "  \n**One-way ANOVA of richness values (2017 vintage)**")
# Tukey's HSD 2017
aov(formula = Richness~AVA,
    data = bact_alpha_test_df %>% 
      filter(Year==2017)) %>% 
  TukeyHSD()%>% tidy %>% kable(caption="  \n**Tukey's HSD of richness values (2016 vintage)**")


```

#### Exponential Shannon


```{r exponential shannon, echo=FALSE}

# Means and SDs
# by vintage
bact_alpha_test_df %>% 
   filter(Vineyard != "AV2" ) %>% 
  filter(Vineyard != "OR2")%>%
  group_by(Year)  %>% 
  summarise(mean=mean(`Exp. Shannon`),
            sd=sd(`Exp. Shannon`))%>%
  kable(caption="  \n**Vintage exponential Shannon means and SDs**")

# 2017
# overall (AV2 and OR2 excluded, because this corresponds with t-test)
bact_alpha_test_df %>% 
  filter(Year ==2017)  %>%
  filter(Vineyard != "AV2" ) %>% 
  filter(Vineyard != "OR2")%>%
  summarise(mean=mean(`Exp. Shannon`), sd=sd(`Exp. Shannon`))%>%
  kable(caption="  \n**2017 exponential Shannon mean and SD**")

# t test (log transformed)
t.test(x=bact_alpha_test_df %>% 
         filter(Year ==2016) %>% 
         select(`Exp. Shannon`)%>% 
         unlist %>% log, 
       y=bact_alpha_test_df %>% 
         filter(Year ==2017) %>% 
         filter(Vineyard != "AV2" ) %>% 
         filter(Vineyard != "OR2")%>%
         select(`Exp. Shannon`) %>% 
         unlist %>% log, 
       paired = TRUE)%>% tidy %>%
  kable(caption="  \n**Paired t-test of log transformed exponential Shannon values between vintages**")

# by AVA
bact_alpha_test_df %>% 
  filter(Year ==2016) %>% 
  group_by(AVA) %>% 
  summarise(mean=mean(`Exp. Shannon`), sd=sd(`Exp. Shannon`))%>% 
kable(caption="  \n**2016 exponential Shannon means and SDs (by AVA)**")

#ANOVA 2016 (log transformed)
aov(formula = `Exp. Shannon` %>% log~AVA,
    data = bact_alpha_test_df %>% 
      filter(Year==2016)) %>% 
  tidy %>% kable(caption = "  \n**One-way ANOVA of log transformed exponential Shannon values (2016 vintage)**")

#Tukey's HSD 2016 (log transformed)
aov(formula = `Exp. Shannon` %>% log~AVA,
    data = bact_alpha_test_df %>% 
      filter(Year==2016)) %>% 
  TukeyHSD()%>% tidy %>% kable(caption="  \n**Tukey's HSD of log transformed exponential Shannon values (2016 vintage)**")



# by AVA (all included, because this corresponds with ANOVA)
bact_alpha_test_df %>% 
  filter(Year ==2017) %>% 
  group_by(AVA) %>% 
  summarise(mean=mean(`Exp. Shannon`), sd=sd(`Exp. Shannon`))%>%
  kable(caption="  \n**2017 exponential Shannon means and SDs (by AVA)**")

#ANOVA 2017
aov(formula = `Exp. Shannon`~AVA,
    data = bact_alpha_test_df %>% 
      filter(Year==2017))  %>% 
  tidy %>% kable(caption = "  \n**One-way ANOVA of exponential Shannon values (2017 vintage)**")

#Tukey's HSD 2017
aov(formula = `Exp. Shannon`~AVA,
    data = bact_alpha_test_df %>% 
      filter(Year==2017)) %>% 
  TukeyHSD()%>% tidy %>% kable(caption="  \n**Tukey's HSD of exponential Shannon values (2016 vintage)**")

```


#### Inverse Simpson


```{r inverse simpson, echo=FALSE}

# Means and SDs
bact_alpha_test_df %>% 
   filter(Vineyard != "AV2" ) %>% 
  filter(Vineyard != "OR2")%>%
  group_by(Year)  %>% 
  summarise(mean=mean(`Inverse Simpson`),
            sd=sd(`Inverse Simpson`))%>%
  kable(caption="  \n**Vintage Inverse Simpson means and SDs**")

# paired t-test
t.test(x=bact_alpha_test_df %>%
              filter(Year ==2016) %>%
              select(`Inverse Simpson`)%>% unlist %>% log, 
            y=bact_alpha_test_df %>% 
              filter(Year ==2017) %>%
              filter(Vineyard != "AV2" ) %>% 
              filter(Vineyard != "OR2")%>%
              select(`Inverse Simpson`) %>% unlist %>% log, 
            paired = TRUE)%>% tidy %>%
  kable(caption="  \n**Paired t-test of log transformed inverse Simpson values between vintages**")


# by AVA
bact_alpha_test_df %>% filter(Year ==2016) %>% 
  group_by(AVA) %>% 
  summarise(mean=mean(`Inverse Simpson`), sd=sd(`Inverse Simpson`))%>% 
kable(caption="  \n**2016 inverse Simpson means and SDs (by AVA)**")


#Kruskal 2016 
kruskal.test(formula = `Inverse Simpson`~AVA,
    data = bact_alpha_test_df %>% 
      filter(Year==2016))%>% 
  tidy %>% kable(caption = "  \n**Kruskal-Wallis of inverse Simpson values (2016 vintage)**")


# by AVA (all included, because this corresponds with ANOVA)
bact_alpha_test_df %>% 
  filter(Year ==2017) %>%
  group_by(AVA) %>% 
  summarise(mean=mean(`Inverse Simpson`), sd=sd(`Inverse Simpson`))%>%
  kable(caption="  \n**2017 inverse Simpson means and SDs (by AVA)**")

#ANOVA 2017 (ns so no Tukey's HSD)
aov(formula = `Inverse Simpson`~AVA,
    data = bact_alpha_test_df %>% 
      filter(Year==2017))  %>% 
  tidy %>% kable(caption = "  \n**One-way ANOVA of inverse Simpson values (2017 vintage)**")


```


### Fungal alpha diversity

#### Richness

```{r richness fung, echo=FALSE}

# Means and SDs

# Means and SDs
fungt_alpha_test_df %>% 
   filter(Vineyard != "AV2" ) %>% 
  filter(Vineyard != "OR2")%>%
  group_by(Year)  %>% 
  summarise(mean=mean(Richness),
            sd=sd(Richness))%>%
  kable(caption="  \n**Vintage richness means and SDs**")


# t test (if both are not significant)
t.test(x=fungt_alpha_test_df %>% 
         filter(Year ==2016) %>% 
         select(Richness)%>% unlist %>% log, 
       y=fungt_alpha_test_df %>% 
         filter(Year ==2017) %>% 
         filter(Vineyard != "AV2" ) %>% 
         filter(Vineyard != "OR2")%>%
         select(Richness) %>% unlist %>% log, 
       paired = TRUE)%>% tidy %>%
  kable(caption="  \n**Paired t-test of richness values between vintages**")

# by AVA
fungt_alpha_test_df %>% 
  filter(Year ==2016) %>% 
  group_by(AVA) %>% 
  summarise(mean=mean(Richness), sd=sd(Richness))%>% 
kable(caption="  \n**2016 richness means and SDs (by AVA)**")

#ANOVA 2016
aov(formula = Richness %>% log ~AVA,
    data = fungt_alpha_test_df %>% 
      filter(Year==2016)) %>% 
  tidy %>% kable(caption = "  \n**One-way ANOVA of log tranformed richness values (2016 vintage)**")
# Tukey's HSD 2016
aov(formula = Richness~AVA,
    data = fungt_alpha_test_df %>% 
      filter(Year==2016)) %>% 
  TukeyHSD()%>% tidy %>% kable(caption="  \n**Tukey's HSD of log transformed richness values (2016 vintage)**")


# by AVA (all included, because this corresponds with ANOVA)
fungt_alpha_test_df %>% 
  filter(Year ==2017) %>% 
  group_by(AVA) %>% 
  summarise(mean=mean(Richness), sd=sd(Richness))%>%
  kable(caption="  \n**2017 richness means and SDs (by AVA)**")

# ANOVA 2017
aov(formula = Richness~AVA,
    data = fungt_alpha_test_df %>% 
      filter(Year==2017))  %>% 
  tidy %>% kable(caption = "  \n**One-way ANOVA of richness values (2017 vintage)**")

# Tukey's HSD 2017
aov(formula = Richness~AVA,
    data = fungt_alpha_test_df %>% 
      filter(Year==2017)) %>% 
  TukeyHSD()%>% tidy %>% kable(caption="  \n**Tukey's HSD of richness values (2017 vintage)**")


```

#### Exponential Shannon


```{r exponential shannon fung, echo=FALSE}


# Means and SDs
fungt_alpha_test_df %>% 
   filter(Vineyard != "AV2" ) %>% 
  filter(Vineyard != "OR2")%>%
  group_by(Year)  %>% 
  summarise(mean=mean(`Exp. Shannon`),
            sd=sd(`Exp. Shannon`))%>%
  kable(caption="  \n**Vintage Exp. Shannon means and SDs**")

# Wilcoxon signed rank
wilcox.test(x=fungt_alpha_test_df %>% 
         filter(Year ==2016) %>% 
         select(`Exp. Shannon`)%>% 
         unlist %>% log, 
       y=fungt_alpha_test_df %>% 
         filter(Year ==2017) %>% 
         filter(Vineyard != "AV2" ) %>% 
         filter(Vineyard != "OR2")%>%
         select(`Exp. Shannon`) %>% 
         unlist %>% log, 
       paired = TRUE)%>% tidy %>%
  kable(caption="  \n**Wilcoxon signed rank of exponential Shannon values between vintages**")


# by AVA
fungt_alpha_test_df %>% 
  filter(Year ==2016) %>% 
  group_by(AVA) %>% 
  summarise(mean=mean(`Exp. Shannon`), sd=sd(`Exp. Shannon`))%>% 
kable(caption="  \n**2016 exponential Shannon means and SDs (by AVA)**")


#ANOVA 2016 
aov(formula = `Exp. Shannon` ~AVA,
    data = fungt_alpha_test_df %>% 
      filter(Year==2016)) %>% 
  tidy %>% kable(caption = "  \n**One-way ANOVA of exponential Shannon values (2016 vintage)**")

#Tukey's HSD 2016
aov(formula = `Exp. Shannon` %>% log~AVA,
    data = fungt_alpha_test_df %>% 
      filter(Year==2016)) %>% 
  TukeyHSD()%>% tidy %>% kable(caption="  \n**Tukey's HSD of exponential Shannon values (2016 vintage)**")


# by AVA (all included, because this corresponds with ANOVA)
fungt_alpha_test_df %>% 
  filter(Year ==2017) %>% 
  group_by(AVA) %>% 
  summarise(mean=mean(`Exp. Shannon`), sd=sd(`Exp. Shannon`))%>%
  kable(caption="  \n**2017 exponential Shannon means and SDs (by AVA)**")

#ANOVA 2017
aov(formula = `Exp. Shannon`~AVA,
    data = fungt_alpha_test_df %>% 
      filter(Year==2017))  %>% 
  tidy %>% kable(caption = "  \n**One-way ANOVA of exponential Shannon values (2017 vintage)**")

#Tukey's HSD 2017
aov(formula = `Exp. Shannon`~AVA,
    data = fungt_alpha_test_df %>% 
      filter(Year==2017)) %>% 
  TukeyHSD()%>% tidy %>% kable(caption="  \n**Tukey's HSD of exponential Shannon values (2017 vintage)**")


```


#### Inverse Simpson


```{r inverse simpson fung, echo=FALSE}

# Means and SDs
# Means and SDs
fungt_alpha_test_df %>% 
   filter(Vineyard != "AV2" ) %>% 
  filter(Vineyard != "OR2")%>%
  group_by(Year)  %>% 
  summarise(mean=mean(`Inverse Simpson`),
            sd=sd(`Inverse Simpson`))%>%
  kable(caption="  \n**Vintage Inverse Simpson means and SDs**")

# wilcoxon signed rank
wilcox.test(x=fungt_alpha_test_df %>%
              filter(Year ==2016) %>%
              select(`Inverse Simpson`)%>% unlist, 
            y=fungt_alpha_test_df %>% 
              filter(Year ==2017) %>%
              filter(Vineyard != "AV2" ) %>% 
              filter(Vineyard != "OR2")%>%
              select(`Inverse Simpson`) %>% unlist, 
            paired = TRUE)%>% tidy %>%
  kable(caption="  \n**Wilcoxon signed rank of inverse Simpson values between vintages**")

# by AVA
fungt_alpha_test_df %>% filter(Year ==2016) %>% 
  group_by(AVA) %>% 
  summarise(mean=mean(`Inverse Simpson`), sd=sd(`Inverse Simpson`))%>% 
kable(caption="  \n**2016 inverse Simpson means and SDs (by AVA)**")

#Kruskal-Wallis 2016 
kruskal.test(formula = `Inverse Simpson`~AVA,
    data = fungt_alpha_test_df %>% 
      filter(Year==2016))%>% 
  tidy %>% kable(caption = "  \n**Kruskal-Wallis of inverse Simpson values (2016 vintage)**")


# by AVA (all included, because this corresponds with ANOVA)
fungt_alpha_test_df %>% 
  filter(Year ==2017) %>%
  group_by(AVA) %>% 
  summarise(mean=mean(`Inverse Simpson`), sd=sd(`Inverse Simpson`))%>%
  kable(caption="  \n**2017 inverse Simpson means and SDs (by AVA)**")

#ANOVA 2017
aov(formula = `Inverse Simpson`~AVA,
    data = fungt_alpha_test_df %>% 
      filter(Year==2017))  %>% 
  tidy %>% kable(caption = "  \n**One-way ANOVA of inverse Simpson values (2017 vintage)**")

#Tukey's HSD 2017
aov(formula = `Inverse Simpson`~AVA,
    data = fungt_alpha_test_df %>% 
      filter(Year==2017)) %>% 
  TukeyHSD()%>% tidy %>% kable(caption="  \n**Tukey's HSD of exponential Shannon values (2017 vintage)**")



```

# Assumption testing
## Climate
### GDD
```{r assumptions GDD, echo=FALSE}
# Shapiro Wilk overall
shapiro.test(merge_samdat %>% select(Growing.Degree.Days) %>% unlist) %>% 
  tidy %>% 
  kable(caption="  \n**Shapiro Wilk of GDD values (both vintages)**")

# Levene test overall
levene.test(y=merge_samdat %>% 
select(Growing.Degree.Days) %>% unlist, 
group=merge_samdat  %>% 
select(AVA) %>% unlist)%>% 
  tidy %>% 
  kable(caption="  \n**Levene's test on GDD values (both vintages)**")

# Shapiro Wilk 2016
shapiro.test(merge_samdat %>% 
filter(Year==2016) %>% 
select(Growing.Degree.Days) %>% unlist)%>% 
  tidy %>% 
  kable(caption="  \n**Shapiro Wilk of GDD values (2016 vintage)**")

# Levene test 2016
levene.test(y=merge_samdat %>% 
filter(Year==2016) %>% 
select(Growing.Degree.Days) %>% unlist, 
group=merge_samdat %>% 
filter(Year==2016) %>% 
select(AVA) %>% unlist)%>% 
  tidy %>% 
  kable(caption="  \n**Levene's test on GDD values (2016 vintage)**")

# Shapiro Wilk 2017
shapiro.test(merge_samdat %>% 
filter(Year==2017) %>% 
select(Growing.Degree.Days) %>% unlist)%>% 
  tidy %>% 
  kable(caption="  \n**Shapiro Wilk of GDD values (2017 vintage)**")

# Levene test 2017
levene.test(y=merge_samdat %>% 
filter(Year==2017) %>% 
select(Growing.Degree.Days) %>% 
unlist, group=merge_samdat %>% 
filter(Year==2017) %>% 
select(AVA) %>% unlist)%>% 
  tidy %>% 
  kable(caption="  \n**Levene's test on GDD values (2017 vintage)**")

```

### Precipitation
```{r assumptions precip, echo=FALSE}

# Shapiro Wilk overall (on log transformed values)
shapiro.test(merge_samdat %>% 
select(Precipitation.growing) %>% unlist %>% log) %>%tidy %>% 
  kable(caption="  \n**Shapiro Wilk of log transformed growing season precipitation values (both vintages)**")

# Levene test overall (on log transformed values)
levene.test(y=merge_samdat %>% 
select(Precipitation.growing) %>% unlist %>% log, group=merge_samdat  %>% 
select(AVA) %>% unlist) %>%
  tidy %>% 
  kable(caption="  \n**Levene's test on log transformed growing season precipitation values (both vintages)**")

#Shapiro Wilk 2016
shapiro.test(merge_samdat %>% 
filter(Year==2016) %>% 
select(Precipitation.growing)%>% unlist %>% log)%>% 
  tidy %>% 
  kable(caption="  \n**Shapiro Wilk of log transformed growing season precipitation values (2016 vintage)**")

# Levene test 2016
levene.test(y=merge_samdat %>% 
filter(Year==2016) %>% 
select(Precipitation.growing) %>% unlist %>% log, group=merge_samdat %>% 
filter(Year==2016) %>% 
select(AVA) %>% unlist) %>%
  tidy %>% 
  kable(caption="  \n**Levene's test on log transformed growing season precipitation values (2016 vintage)**")

#Shapiro Wilk 2017
shapiro.test(merge_samdat %>% 
filter(Year==2017) %>% 
select(Precipitation.growing) %>% unlist %>% log)%>% 
  tidy %>% 
  kable(caption="  \n**Shapiro Wilk of log transformed growing season precipitation values (2017 vintage)**")

# Levene test 2017
levene.test(y=merge_samdat %>% 
filter(Year==2017) %>% 
select(Precipitation.growing) %>% unlist %>% log, group=merge_samdat %>% 
filter(Year==2017) %>% 
select(AVA) %>% unlist)%>%
  tidy %>% 
  kable(caption="  \n**Levene's test on log transformed growing season precipitation values (2017 vintage)**")

```

## Fruit maturity metrics
### pH
```{r assumptions ph, echo=FALSE}

###pH
# Shapiro Wilk overall
shapiro.test(merge_samdat %>% 
select(Must_pH) %>% unlist ) %>%tidy %>% 
  kable(caption="  \n**Shapiro Wilk of pH (both vintages)**")

# Levene test overall
levene.test(y=merge_samdat %>% 
select(Must_pH) %>% unlist , 
group=merge_samdat  %>% 
select(AVA) %>% unlist)%>% 
  tidy %>% 
  kable(caption="  \n**Levene's test on pH  (both vintages)**" )

# Shapiro Wilk 2016
shapiro.test(merge_samdat %>% 
filter(Year==2016) %>% 
select(Must_pH)%>% unlist )%>%tidy %>% 
  kable(caption="  \n**Shapiro Wilk of pH (2016 vintage)**")

# Levene test 2016
levene.test(y=merge_samdat %>% 
filter(Year==2016) %>% 
select(Must_pH) %>% unlist , 
group=merge_samdat %>% 
filter(Year==2016) %>% 
select(AVA) %>% unlist)%>% 
  tidy %>% 
  kable(caption="  \n**Levene's test on pH  (2016 vintage)**" )

# Shapiro Wilk 2017
shapiro.test(merge_samdat %>% 
filter(Year==2017) %>% 
select(Must_pH) %>% unlist )%>%tidy %>% 
  kable(caption="  \n**Shapiro Wilk of pH (2017 vintage)**")

# Levene test 2017
levene.test(y=merge_samdat %>% 
filter(Year==2017) %>% 
select(Must_pH) %>% unlist , 
group=merge_samdat %>% 
filter(Year==2017) %>% 
select(AVA) %>% unlist)%>% 
  tidy %>% 
  kable(caption="  \n**Levene's test on pH  (2017 vintage)**" )

```

### Titratable acidity (TA)
```{r assumptions ta, echo=FALSE}

##TA
# Shapiro Wilk
shapiro.test(merge_samdat %>% 
select(Must_TA) %>% unlist ) %>%tidy %>% 
  kable(caption="  \n**Shapiro Wilk of titratable acidity values (both vintages)**")

# Levene test overall
levene.test(y=merge_samdat %>% 
select(Must_TA) %>% unlist , 
group=merge_samdat  %>% 
select(AVA) %>% unlist)%>% 
  tidy %>% 
  kable(caption="  \n**Levene's test on titratable acidity values (both vintages)**")

# Shapiro Wilk 2016
shapiro.test(merge_samdat %>% 
filter(Year==2016) %>% 
select(Must_TA)%>% unlist )%>% tidy %>%
  kable(caption="  \n**Shapiro Wilk of titratable acidity values (2016 vintage)**")


# Levene test 2016
levene.test(y=merge_samdat %>% 
filter(Year==2016) %>% 
select(Must_TA) %>% unlist , 
group=merge_samdat %>% 
filter(Year==2016) %>% 
select(AVA) %>% unlist)%>% 
  tidy %>% 
  kable(caption="  \n**Levene's test on titratable acidity values (2016 vintage)**")

# Shapiro Wilk 2017
shapiro.test(merge_samdat %>% 
filter(Year==2017) %>% 
select(Must_TA) %>% unlist )%>% tidy %>%
  kable(caption="  \n**Shapiro Wilk of titratable acidity values (2017 vintage)**")

# Levene test 2017
levene.test(y=merge_samdat %>% 
filter(Year==2017) %>% 
select(Must_TA) %>% unlist , 
group=merge_samdat %>% 
filter(Year==2017) %>% 
select(AVA) %>% unlist)%>% 
  tidy %>% 
  kable(caption="  \n**Levene's test on titratable acidity values (2017 vintage)**")
```

### Total soluble solids (TSS)
```{r assumptions tss, echo=FALSE}

# Shapiro Wilk overall
shapiro.test(merge_samdat %>% 
select(Must_TSS) %>% unlist ) %>%tidy %>% 
  kable(caption="  \n**Shapiro Wilk of TSS values (both vintages)**")

# Levene test overall
levene.test(y=merge_samdat %>% 
select(Must_TSS) %>% unlist , 
group=merge_samdat  %>% 
select(AVA) %>% unlist)%>% 
  tidy %>% 
  kable(caption="  \n**Levene's test on TSS values (both vintages)**")

#Shapiro Wilk 2016
shapiro.test(merge_samdat %>% 
filter(Year==2016) %>% 
select(Must_TSS)%>% unlist ) %>%tidy %>% 
  kable(caption="  \n**Shapiro Wilk of TSS values (2016 vintage)**")

#Levene test 2016
levene.test(y=merge_samdat %>% 
filter(Year==2016) %>% 
select(Must_TSS) %>% unlist , 
group=merge_samdat %>% 
filter(Year==2016) %>% 
select(AVA) %>% unlist)%>% 
  tidy %>% 
  kable(caption="  \n**Levene's test on TSS values (2016 vintage)**")

#Shapiro Wilk 2017
shapiro.test(merge_samdat %>% 
filter(Year==2017)  %>% 
select(Must_TSS)%>% unlist %>% log) %>%tidy %>% 
  kable(caption="  \n**Shapiro Wilk of TSS values (2017 vintage)**")

# Levene test 2017
levene.test(y=merge_samdat %>% 
filter(Year==2017) %>% 
select(Must_TSS) %>% unlist %>% log, 
group=merge_samdat %>%
filter(Year==2017) %>% 
select(AVA) %>% unlist)%>% 
  tidy %>% 
  kable(caption="  \n**Levene's test on TSS values (2017 vintage)**")


```

## Alpha diversity
### Bacterial alpha diversity
#### Richness
```{r richness bact assumptions, echo=FALSE}
# Shapiro Wilk overall
shapiro.test(bact_alpha_test_df %>% 
select(Richness) %>% unlist) %>%tidy %>% 
  kable(caption="  \n**Shapiro Wilk of richness values (both vintages)**")

# Levene test overall
levene.test(y=bact_alpha_test_df %>% 
select(Richness) %>% unlist, 
group=bact_alpha_test_df  %>% 
select(AVA) %>% unlist)%>% tidy %>%
  kable(caption="  \n**Levene of richness values (both vintages)**")

# Shapiro Wilk 2016
shapiro.test(bact_alpha_test_df %>% 
filter(Year==2016) %>% 
select(Richness) %>% unlist)%>% tidy %>%
  kable(caption="  \n**Shapiro Wilk of richness values (2016 vintage)**")


#Levene test 2016
levene.test(y=bact_alpha_test_df %>% 
filter(Year==2016) %>% 
select(Richness) %>% unlist, 
group=bact_alpha_test_df %>% 
filter(Year==2016) %>% 
select(AVA) %>% unlist)%>% tidy %>%
  kable(caption="  \n**Shapiro Wilk of richness values (2016 vintage)**")

#Shapiro Wilk 2017
shapiro.test(bact_alpha_test_df %>% 
filter(Year==2017) %>% 
select(Richness) %>% unlist)%>% tidy %>%
  kable(caption="  \n**Shapiro Wilk of richness values (2017 vintage)**")

#Levene test 2017
levene.test(y=bact_alpha_test_df %>% 
filter(Year==2017) %>% 
select(Richness) %>% unlist, 
group=bact_alpha_test_df %>% 
filter(Year==2017) %>% 
select(AVA) %>% unlist)%>% tidy %>%
  kable(caption="  \n**Shapiro Wilk of richness values (2017 vintage)**")

```

#### Exponential Shannon
```{r exp shannon bact assumptions, echo=FALSE}

# Shapiro Wilk overall
shapiro.test(bact_alpha_test_df %>% 
select(`Exp. Shannon`)  %>% unlist %>% log )%>%tidy %>% 
  kable(caption="  \n**Shapiro Wilk of log transformed exponential Shannon values (both vintages)**")

# Levene overall
levene.test(y=bact_alpha_test_df %>% 
select(`Exp. Shannon`) %>% unlist %>% log, 
group=bact_alpha_test_df  %>% 
select(AVA) %>% unlist)%>%tidy %>% 
  kable(caption="  \n**Levene of log transformed exponential Shannon values (both vintages)**")

# Shapiro Wilk 2016
shapiro.test(bact_alpha_test_df %>% 
filter(Year==2016) %>% 
select(`Exp. Shannon`) %>% 
unlist%>% log )%>%tidy %>% 
  kable(caption="  \n**Shapiro Wilk of log transformed exponential Shannon values (2016 vintage)**")


# Levene 2016
levene.test(y=bact_alpha_test_df %>% 
filter(Year==2016) %>% 
select(`Exp. Shannon`) %>% unlist%>% log, 
group=bact_alpha_test_df %>% 
filter(Year==2016) %>% 
select(AVA) %>% unlist)%>% tidy %>%
  kable(caption="  \n**Levene of log transformed exponential Shannon values (2016 vintage)**")


# Shapiro Wilk 2017
shapiro.test(bact_alpha_test_df %>% 
filter(Year==2017) %>% 
select(`Exp. Shannon`) %>% unlist)%>%tidy %>% 
  kable(caption="  \n**Shapiro Wilk of exponential Shannon values (2017 vintage)**")

# Levene 2017
levene.test(y=bact_alpha_test_df %>% 
filter(Year==2017) %>% 
select(`Exp. Shannon`) %>% unlist,
group=bact_alpha_test_df %>% 
filter(Year==2017) %>% 
select(AVA) %>% unlist)%>% tidy %>%
  kable(caption="  \n**Levene of exponential Shannon values (2017 vintage)**")

```

#### Inverse Simpson
```{r inverse simpson bact assumptions, echo=FALSE}
# Shapiro Wilk overall
shapiro.test(bact_alpha_test_df %>%
select(`Inverse Simpson`) %>%unlist %>% log )%>%tidy %>% 
  kable(caption="  \n**Shapiro Wilk of log transformed inverse Simpson values (both vintages)**")

# Levene overall
levene.test(y=bact_alpha_test_df %>% 
select(`Inverse Simpson`) %>% unlist %>% log , 
group=bact_alpha_test_df  %>% 
select(AVA) %>% unlist)%>%tidy %>% 
  kable(caption="  \n**Levene of log transformed inverse Simpson values (both vintages)**")

#Shapiro Wilk 2016 vintage
shapiro.test(bact_alpha_test_df %>% 
filter(Year==2016) %>% 
select(`Inverse Simpson`) %>% unlist %>% log )%>%tidy %>% 
  kable(caption="  \n**Shapiro Wilk of log transformed inverse Simpson values (2016 vintage)**")

# Levene 2016 vintage
levene.test(y=bact_alpha_test_df %>% 
filter(Year==2016) %>% 
select(`Inverse Simpson`) %>% unlist %>% log, 
group=bact_alpha_test_df %>% 
filter(Year==2016) %>% 
select(AVA) %>% unlist)%>% tidy %>%
  kable(caption="  \n**Levene of inverse Simpson values (2016 vintage)**")

#Shapiro Wilk 2017 vintage
shapiro.test(bact_alpha_test_df %>% 
filter(Year==2017) %>% 
select(`Inverse Simpson`) %>% unlist) %>%tidy %>% 
  kable(caption="  \n**Shapiro Wilk of inverse Simpson values (2017 vintage)**")

# Levene 2017
levene.test(y=bact_alpha_test_df %>% 
filter(Year==2017) %>% 
select(`Inverse Simpson`) %>% unlist, 
group=bact_alpha_test_df %>% 
filter(Year==2017) %>% 
select(AVA) %>% unlist)%>% tidy %>%
  kable(caption="  \n**Levene of inverse Simpson values (2017 vintage)**")

```

### Fungal alpha diversity
#### Richness

```{r richness fung assumptions, echo=FALSE}
# Shapiro Wilk overall
shapiro.test(fungt_alpha_test_df %>% 
select(Richness) %>% unlist %>% log)%>%tidy %>% 
  kable(caption="  \n**Shapiro Wilk of log transformed richness values (both vintages)**")

# Levene test overall
levene.test(y=fungt_alpha_test_df %>% 
select(Richness) %>% unlist %>% log, 
group=fungt_alpha_test_df  %>% 
select(AVA) %>% unlist)%>%tidy %>% 
  kable(caption="  \n**Levene of log transformed richness values (both vintages)**")


# Shapiro Wilk 2016
shapiro.test(fungt_alpha_test_df %>% 
filter(Year==2016) %>% 
select(Richness) %>% unlist %>% log)%>%tidy %>% 
  kable(caption="  \n**Shapiro Wilk of log transformed richness values (2016 vintage)**")

#Levene test 2016
levene.test(y=fungt_alpha_test_df %>% 
filter(Year==2016) %>% 
select(Richness) %>% unlist %>% log, 
group=fungt_alpha_test_df %>% 
filter(Year==2016) %>% 
select(AVA) %>% unlist)%>% tidy %>%
  kable(caption="  \n**Levene of log transformed richness values (2016 vintage)**")

#Shapiro Wilk 2017
shapiro.test(fungt_alpha_test_df %>% 
filter(Year==2017) %>% 
select(Richness) %>% unlist) %>%tidy %>% 
  kable(caption="  \n**Shapiro Wilk of richness values (2017 vintage)**")

#Levene test 2017
levene.test(y=fungt_alpha_test_df %>% 
filter(Year==2017) %>% 
select(Richness) %>% unlist, 
group=fungt_alpha_test_df %>% 
filter(Year==2017) %>% 
select(AVA) %>% unlist)%>% tidy %>%
  kable(caption="  \n**Levene of richness values (2017 vintage)**")

```

#### Exponential Shannon

```{r exp shannon fung assumptions, echo=FALSE}

# Shapiro Wilk overall
shapiro.test(fungt_alpha_test_df %>% 
select(`Exp. Shannon`)  %>% unlist %>% log )%>%tidy %>% 
  kable(caption="  \n**Shapiro Wilk of log transformed exponential Shannon values (both vintages)**")

# Levene overall
levene.test(y=fungt_alpha_test_df %>% 
select(`Exp. Shannon`) %>% unlist %>% log, 
group=fungt_alpha_test_df  %>% 
select(AVA) %>% unlist)%>%tidy %>% 
  kable(caption="  \n**Levene of log transformed exponential Shannon values (both vintages)**")

# Shapiro Wilk 2016
shapiro.test(fungt_alpha_test_df %>% 
filter(Year==2016) %>% 
select(`Exp. Shannon`) %>% 
unlist  )%>%tidy %>% 
  kable(caption="  \n**Shapiro Wilk of exponential Shannon values (2016 vintage)**")

# Levene 2016
levene.test(y=fungt_alpha_test_df %>% 
filter(Year==2016) %>% 
select(`Exp. Shannon`) %>% unlist, 
group=fungt_alpha_test_df %>% 
filter(Year==2016) %>% 
select(AVA) %>% unlist)%>% tidy %>%
  kable(caption="  \n**Levene of exponential Shannon values (2016 vintage)**")


# Shapiro Wilk 2017
shapiro.test(fungt_alpha_test_df %>% 
filter(Year==2017) %>% 
select(`Exp. Shannon`) %>% unlist) %>%tidy %>% 
  kable(caption="  \n**Shapiro Wilk of exponential Shannon values (2017 vintage)**")

# Levene 2017
levene.test(y=fungt_alpha_test_df %>% 
filter(Year==2017) %>% 
select(`Exp. Shannon`) %>% unlist,
group=fungt_alpha_test_df %>% 
filter(Year==2017) %>% 
select(AVA) %>% unlist)%>% tidy %>%
  kable(caption="  \n**Levene of exponential Shannon values (2017 vintage)**")

```

#### Inverse Simpson

```{r inverse simpson fung assumptions, echo=FALSE}
# Shapiro Wilk overall
shapiro.test(fungt_alpha_test_df %>%
select(`Inverse Simpson`) %>%unlist %>% log )%>%tidy %>% 
  kable(caption="  \n**Shapiro Wilk of log transformed inverse Simpson values (both vintages)**")

# Levene overall
levene.test(y=fungt_alpha_test_df %>% 
select(`Inverse Simpson`) %>% unlist %>% log , 
group=fungt_alpha_test_df  %>% 
select(AVA) %>% unlist)%>%tidy %>% 
  kable(caption="  \n**Levene of log transformed inverse Simpson values (both vintages)**")

#Shapiro Wilk 2016 vintage
shapiro.test(fungt_alpha_test_df %>% 
filter(Year==2016) %>% 
select(`Inverse Simpson`) %>% unlist %>% log)%>%tidy %>% 
  kable(caption="  \n**Shapiro Wilk of log transformed inverse Simpson values (2016 vintage)**")

# Levene 2016 vintage
levene.test(y=fungt_alpha_test_df %>% 
filter(Year==2016) %>% 
select(`Inverse Simpson`) %>% unlist %>% log, 
group=fungt_alpha_test_df %>% 
filter(Year==2016) %>% 
select(AVA) %>% unlist)%>% tidy %>%
  kable(caption="  \n**Levene of log transformed inverse Simpson values (2016 vintage)**")

#Shapiro Wilk 2017 vintage
shapiro.test(fungt_alpha_test_df %>% 
filter(Year==2017) %>% 
select(`Inverse Simpson`) %>% unlist) %>%tidy %>% 
  kable(caption="  \n**Shapiro Wilk of inverse Simpson values (2017 vintage)**")

# Levene 2017
levene.test(y=fungt_alpha_test_df %>% 
filter(Year==2017) %>% 
select(`Inverse Simpson`) %>% unlist, 
group=fungt_alpha_test_df %>% 
filter(Year==2017) %>% 
select(AVA) %>% unlist)%>% tidy %>%
  kable(caption="  \n**Levene of inverse Simpson values (2017 vintage)**")

```